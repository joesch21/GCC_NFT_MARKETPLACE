<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome to GCC</title>

  <!-- SEO / Meta -->
  <meta name="description" content="Explore the GCC NFT Universe on BNB Chain." />
  <meta property="og:title" content="GCC NFT Portal" />
  <meta property="og:description" content="Connect your wallet to view or purchase GCC NFTs." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://yourdomain.com/images/og.png" />
  <meta name="apple-itunes-app" content="app-id=1438144202">

  <!-- Styles -->
  <link rel="icon" href="logo512.png" type="image/png" />
  <link rel="stylesheet" href="global.css" />
  <link rel="stylesheet" href="styles/index.css" />
</head>

<body>
  <header>
    <h1 class="page-header">Welcome to GCC NFT Portal</h1>
    <div id="walletStatus" class="wallet-badge">Wallet not connected</div>
    <div class="wallet-buttons">
      <button id="connectBtn" onclick="connectMetaMask()">üîå Connect Wallet</button>
      <button id="disconnectBtn" class="hidden" onclick="disconnectWallet()">‚ùå Disconnect</button>
    </div>
  </header>

  <main class="container">
    <h2>Choose Your Path</h2>
    <nav class="nav-buttons">
      <a href="gallery.html"><button> View My NFTs</button></a>
      <a href="marketplace.html"><button>Explore Marketplace</button></a>
    </nav>
  </main>

  <div id="toast"></div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js" defer></script>
  <script src="shared.js" defer></script>
  <script>
    const tokenAddress = "0x092ac429b9c3450c9909433eb0662c3b7c13cf9a";
    const tokenSymbol = "GCC";
    const tokenDecimals = 18;
    const tokenImage = "https://storage.top100token.com/images/fe7c179d-bfa8-4d49-a460-ca87ca248167.webp";
    const dexscreenerApi = `https://api.dexscreener.com/latest/dex/pairs/bsc/0x3d32d359bdad07C587a52F8811027675E4f5A833`;

    window.addEventListener("DOMContentLoaded", async () => {
      if (sessionStorage.getItem("walletConnected")) {
        try {
          await window.app.connect();
          updateUI(true);
        } catch {
          updateUI(false);
        }
      }
    });

    async function connectMetaMask() {
      try {
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

        if (window.ethereum) {
          const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
          console.log("Connected wallet:", accounts[0]);
          alert(`Connected wallet: ${accounts[0]}`);
          await window.app.connect();
          updateUI(true);
        } else if (isMobile) {
          alert("You‚Äôll now be redirected to MetaMask to connect your wallet.");
          const dappDomain = "nft.gimpnftgallery.com"; // ‚Üê your real domain
          window.location.href = `https://metamask.app.link/dapp/${dappDomain}`;
        } else {
          alert('MetaMask is not detected. Please install it from https://metamask.io');
        }
      } catch (err) {
        console.error("MetaMask connection error:", err);
        alert("Connection failed. Please try again.");
        updateUI(false);
      }
    }

    function disconnectWallet() {
      window.app.disconnect();
      updateUI(false);
    }

    function updateUI(connected) {
      const status = document.getElementById("walletStatus");
      const connectBtn = document.getElementById("connectBtn");
      const disconnectBtn = document.getElementById("disconnectBtn");

      if (connected && window.app.userAddress) {
        status.textContent = `Connected: ${window.app.userAddress}`;
        connectBtn.classList.add("hidden");
        disconnectBtn.classList.remove("hidden");
      } else {
        status.textContent = "Wallet not connected";
        connectBtn.classList.remove("hidden");
        disconnectBtn.classList.add("hidden");
      }
    }
  </script>
</body>
</html>
